(this.webpackJsonpcounter=this.webpackJsonpcounter||[]).push([[0],{14:function(e,t,n){e.exports=n.p+"static/media/kebab.1533b4c2.svg"},17:function(e,t,n){e.exports=n(30)},22:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(6),l=n.n(r),o=(n(22),n(8)),s=n(1),u=n(2),c=n(4),d=n(3),h=n(13),p=n.n(h),v=["red","dark-blue","light-blue","green","yellow","purple"],m=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={title:"",value:0,valueValid:!0,step:1,stepValid:!0,color:"light-blue",editable:!1},a}return Object(u.a)(n,[{key:"handleTitleChange",value:function(e){this.setState({title:e.target.value})}},{key:"handleValueChange",value:function(e){this.setState({value:e.target.value,valueValid:e.target.validity.valid})}},{key:"handleStepChange",value:function(e){this.setState({step:e.target.value,stepValid:e.target.validity.valid})}},{key:"handleColorChange",value:function(e){this.setState({color:e.target.value})}},{key:"createCounter",value:function(e){if(e.preventDefault(),this.state.valueValid&&this.state.stepValid){var t={title:this.state.title,value:parseInt(this.state.value),step:parseInt(this.state.step),color:this.state.color};this.props.addCounter(t),this.setState({title:""})}}},{key:"render",value:function(){var e=this;return i.a.createElement("table",{id:"counter-creator",className:this.state.color},i.a.createElement("tbody",null,i.a.createElement("tr",{id:"tvs"},i.a.createElement("td",null,i.a.createElement("label",null,"Title"),i.a.createElement("input",{type:"text",placeholder:"Title",onChange:this.handleTitleChange.bind(this),value:this.state.title})),i.a.createElement("td",{className:"input-num-td"},i.a.createElement("label",null,"Value"),i.a.createElement("input",{type:"number",min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,required:!0,onChange:this.handleValueChange.bind(this),value:this.state.value})),i.a.createElement("td",{id:"cc-step-input",className:"input-num-td"},i.a.createElement("label",null,"Step"),i.a.createElement("input",{type:"number",required:!0,min:1,max:Number.MAX_SAFE_INTEGER,onChange:this.handleStepChange.bind(this),value:this.state.step}))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"3"},v.map((function(t){return i.a.createElement("button",{className:"".concat(t,"-color-selector-button focus-color"),value:t,onClick:e.handleColorChange.bind(e),key:t})})))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"3"},i.a.createElement("button",{onClick:this.createCounter.bind(this),className:"".concat(this.state.color,"-button create-button")},"Create")))))}}]),n}(i.a.Component),b=n(14),f=n.n(b),g=n(5),E=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"dec",value:function(){this.props.functions.decrement(this.props.counter)}},{key:"inc",value:function(){this.props.functions.increment(this.props.counter)}},{key:"edit",value:function(){this.props.functions.toggleEditable(this.props.counter)}},{key:"deleteCounter",value:function(){this.props.functions.deleteCounter(this.props.counter)}},{key:"render",value:function(){var e=this,t=this.props.counter,n="".concat(t.color,"-button");return i.a.createElement(g.b,{draggableId:t.id,index:this.props.functions.getIndex(t)},(function(a,r){return i.a.createElement("tr",Object.assign({ref:a.innerRef},a.draggableProps,a.dragHandleProps),i.a.createElement("td",{className:"".concat(t.color," title-td")}," ",t.title),i.a.createElement("td",{className:t.color},i.a.createElement("button",{className:n,onClick:e.dec.bind(e)}," -")),i.a.createElement("td",{className:"".concat(t.color," value-td")}," ",t.value," "),i.a.createElement("td",{className:t.color},i.a.createElement("button",{className:n,onClick:e.inc.bind(e)}," +")),i.a.createElement("td",{className:"dropdown ".concat(t.color)},i.a.createElement("img",{src:f.a,alt:""}),i.a.createElement("div",{className:"dropdown-options-content"},i.a.createElement("button",{className:"".concat(n," edit-button"),onClick:e.edit.bind(e)},"Edit"),i.a.createElement("button",{className:"".concat(n," delete-button"),onClick:e.deleteCounter.bind(e)},"Delete"))))}))}}]),n}(i.a.Component),C=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={title:e.counter.title,value:e.counter.value,valueValid:!0,step:e.counter.step,stepValid:!0,color:e.counter.color,editable:!1},a}return Object(u.a)(n,[{key:"handleTitleChange",value:function(e){this.setState({title:e.target.value})}},{key:"handleValueChange",value:function(e){this.setState({value:e.target.value,valueValid:e.target.validity.valid})}},{key:"handleStepChange",value:function(e){this.setState({step:e.target.value,stepValid:e.target.validity.valid})}},{key:"handleColorChange",value:function(e){this.setState({color:e.target.value})}},{key:"save",value:function(){if(this.state.valueValid&&this.state.stepValid){var e={title:this.state.title,value:parseInt(this.state.value),step:parseInt(this.state.step),color:this.state.color,editable:!1};this.props.functions.edit(this.props.counter,e)}}},{key:"cancel",value:function(){this.props.functions.toggleEditable(this.props.counter)}},{key:"render",value:function(){var e=this,t=this.props.counter,n="".concat(this.state.color,"-button");return i.a.createElement(g.b,{draggableId:t.id,index:this.props.functions.getIndex(t)},(function(t,a){return i.a.createElement("tr",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"edit-row"}),i.a.createElement("td",{className:"".concat(e.state.color," editor-inputs"),colSpan:"3"},i.a.createElement("label",null,"Title"),i.a.createElement("input",{type:"text",onChange:e.handleTitleChange.bind(e),placeholder:"title",value:e.state.title}),i.a.createElement("label",null,"Value"),i.a.createElement("input",{type:"number",required:!0,min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,onChange:e.handleValueChange.bind(e),value:e.state.value}),i.a.createElement("label",null,"Step"),i.a.createElement("input",{type:"number",required:!0,min:1,max:Number.MAX_SAFE_INTEGER,onChange:e.handleStepChange.bind(e),value:e.state.step})),i.a.createElement("td",{className:"".concat(e.state.color," color-editor-td"),colSpan:"2"},i.a.createElement("div",{className:"color-editor"},v.map((function(t){return i.a.createElement("button",{className:"".concat(t,"-color-selector-button focus-color"),value:t,onClick:e.handleColorChange.bind(e),key:t})}))),i.a.createElement("button",{className:n,onClick:e.save.bind(e)},"Save"),i.a.createElement("button",{className:n,onClick:e.cancel.bind(e)},"Cancel")))}))}}]),n}(i.a.Component),y=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"onDragEnd",value:function(e){this.props.functions.onDragEnd(e)}},{key:"render",value:function(){var e=this.props,t=e.counters,n=e.functions;return i.a.createElement(g.c,{droppableId:"table"},(function(e,a){return i.a.createElement("table",Object.assign({style:{width:"100%"},id:"counter-table",ref:e.innerRef},e.droppableProps),i.a.createElement("tbody",null,t.map((function(e){return e.editable?i.a.createElement(C,{counter:e,functions:n,key:e.id}):i.a.createElement(E,{counter:e,functions:n,key:e.id})})),e.placeholder))}))}}]),n}(i.a.Component),k=n(7),N=n(16),S=n.n(N),O={title:"",value:0,step:0,color:v[0]},I=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,[{key:"initiateBridge",value:function(){var e=this;this.componentManager=new S.a([{name:"stream-context-item"}],(function(){e.onReady&&e.onReady()})),this.componentManager.streamContextItem((function(t){e.note=t,t.isMetadataUpdate||(e.dataString=t.content.text,e.reloadData(),e.dataChangeHandler&&e.dataChangeHandler(e.counters))}))}},{key:"getPlatform",value:function(){return this.componentManager.platform}},{key:"isMobile",value:function(){return this.componentManager&&"mobile"===this.componentManager.environment}},{key:"setOnReady",value:function(e){this.onReady=e}},{key:"setDataChangeHandler",value:function(e){this.dataChangeHandler=e}},{key:"parseRawCountersString",value:function(e){var t=this;if(this.idCount=0,!e)return[];var n=e.split("\n").map((function(e){var t="";try{t=JSON.parse(e)}catch(n){console.error("Error parsing ".concat(e))}return t})).filter((function(e){return""!==e})).map((function(e){return Object(k.a)(Object(k.a)({},O),t.setInfo(e))}));return n=n.map((function(e){return v.includes(e.color)||(e.color=v[0]),e}))}},{key:"setInfo",value:function(e){return e.id="".concat(e.title).concat(this.idCount++),e.editable=!1,e}},{key:"reloadData",value:function(){this.idCount=0,this.counters=this.parseRawCountersString(this.dataString)}},{key:"getCounters",value:function(){return this.counter||this.reloadData(),this.counters}},{key:"addCounter",value:function(e){this.setInfo(e),this.counters.push(e),this.save(),this.reloadData()}},{key:"deleteCounter",value:function(e){var t=this.counters.indexOf(e);this.counters.splice(t,1),this.save()}},{key:"increment",value:function(e){var t=e.value+e.step;if(!(t>Number.MAX_SAFE_INTEGER)){var n=this.counters.indexOf(e);this.counters[n].value=t,this.save()}}},{key:"decrement",value:function(e){var t=e.value-e.step;if(!(t<Number.MIN_SAFE_INTEGER)){var n=this.counters.indexOf(e);this.counters[n].value=t,this.save()}}},{key:"editCounter",value:function(e,t){var n=this.counters.findIndex((function(t){return t.id===e.id}));this.counters[n]=Object(k.a)(Object(k.a)({},e),t),this.save()}},{key:"rearrange",value:function(e,t){var n=Object.assign([],this.counters),a=this.counters[t.index];n.splice(t.index,1),n.splice(e.index,0,a),this.counters=n,this.save()}},{key:"buildHtmlPreview",value:function(){if(0===this.counters.length)return"";for(var e="<div><ul>",t=0;t<3&&t<this.counters.length;){var n=this.counters[t];e+="<li>".concat(n.title,": ").concat(n.value,"</li>"),t+=1}return e+"</ul></div>"}},{key:"save",value:function(){var e=this;if(this.dataString=this.counters.map((function(e){var t=e.title,n=e.value,a=e.step,i=e.color;return JSON.stringify({title:t,value:n,step:a,color:i})})).join("\n"),this.note){var t=this.note;this.componentManager.saveItemWithPresave(t,(function(){t.content.text=e.dataString,t.content.preview_html=e.buildHtmlPreview()}))}}}],[{key:"get",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),e}();I.instance=null;var j=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={counters:[],draggingRowID:null},I.get().setDataChangeHandler((function(e){a.updateCounters()})),I.get().setOnReady((function(){var e=I.get().getPlatform();document.documentElement.className+=e,a.setState({ready:!0})})),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){I.get().initiateBridge(),this.updateCounters()}},{key:"updateCounters",value:function(){this.setState({counters:I.get().getCounters()})}},{key:"addCounter",value:function(e){I.get().addCounter(e),this.updateCounters()}},{key:"getIndex",value:function(e){return this.state.counters.indexOf(e)}},{key:"toggleEditable",value:function(e){var t=this.state.counters.indexOf(e);this.setState({counters:p()(this.state.counters,Object(o.a)({},t,{editable:{$set:!e.editable}}))})}},{key:"deleteCounter",value:function(e){I.get().deleteCounter(e),this.updateCounters()}},{key:"increment",value:function(e){I.get().increment(e),this.updateCounters()}},{key:"decrement",value:function(e){I.get().decrement(e),this.updateCounters()}},{key:"editCounter",value:function(e,t){I.get().editCounter(e,t),this.updateCounters()}},{key:"onDragEnd",value:function(e){var t=e.destination,n=e.source,a=e.reason;t&&"CANCEL"!==a?t.droppableId===n.droppableId&&t.index===n.index||(I.get().rearrange(t,n),this.updateCounters()):this.setState({draggingRowId:null})}},{key:"render",value:function(){var e={increment:this.increment.bind(this),decrement:this.decrement.bind(this),edit:this.editCounter.bind(this),onDragEnd:this.onDragEnd.bind(this),getIndex:this.getIndex.bind(this),toggleEditable:this.toggleEditable.bind(this),deleteCounter:this.deleteCounter.bind(this)};return i.a.createElement("div",{id:"counters"},i.a.createElement(m,{addCounter:this.addCounter.bind(this)}),i.a.createElement(g.a,{onDragEnd:this.onDragEnd.bind(this)},i.a.createElement(y,{counters:this.state.counters,functions:e})))}}]),n}(i.a.Component);var x=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(j,null))};l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(x,null)),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.90dfe230.chunk.js.map